#!/usr/bin/env bash
set -x

dir=~/opt/Screenshots/maim
name="maim-$(date +%F_%H:%M:%S)"
dn="$dir/$name.png"

mkdir -p "$dir" || exit 1

newname() {
	name1="${name}-$(file ${dir}/${name}.png | \
		awk '{gsub(",","")} {print $5 "x" $7}')" &&
	dn1="$dir/$name1.png"
	mv "$dn" "$dn1"
}

case $1 in
	-f) maim -ui $(xdotool getactivewindow) "${dir}/${name}.png";;
	-s) maim -su -b 8 "${dir}/${name}.png";;
	*) maim -u "${dir}/${name}.png";;
esac

newname || exit
preview "$dn1"
