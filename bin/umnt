#!/bin/sh -e

fe() {
	while read -r l; do
		set -- $l
		grep -iq "$2" /etc/fstab ||
			printf '%s\n' "$1 $2"
	done
}

dis=$(lsblk -o 'name,mountpoint' | grep -e ' /' | tr -d '─└├' | fe | menu)

[ -e "/dev/${dis%% *}" ] || exit 1
sudo umount "${dis#* }"
rmdir "$HOME/opt/mnt/${dis%% *}"
notify-send "Unmounted ${dis%% *}" "${dis#* }"
