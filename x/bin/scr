#!/bin/sh
n="$HOME/opt/x/pics/$(date +%F_%H-%M-%S).png"
mkdir -p "${n%/*}"

case $1 in
	-s) maim /tmp/pic
		feh -g 3360x1082+0+-1 --class feh-nb /tmp/pic &
		pid=$!
		maim -su -b 8 "$n";  kill $pid;;
	# screenshot focused window
	-f) maim -ui "$(xdotool getactivewindow)" "$n";;
	# screenshot current monitor
	*) maim -u "$n" -g "$(mattr whxy "$(pfm)" | sed -e 's/ /+/g' -e "s/+/x/")"
esac

# add resolution to filename
n1="${n%.*}-$(identify -format "%wx%h" "$n").png"
mv "$n" "$n1"
# copy image
xclip -sel clipboard -t image/png "$n1"
